#!/usr/bin/python
''' 
Content:	exploitDev fuzzing Helper: Takes a textfile containing a networkStream (for 
		example from wireshark) and convert it into a fuzzing template for spike "fuzz.txt"
Author: 	Florian Hansemann | @HanseSecure | https://hansesecure.de
Date: 		02/2018
	
Usage:		python netStream2spike.py stream.txt
		
'''

import sys,re

if len(sys.argv) != 2:
	print "You need a file to convert ;-) python netStream2spike.py stream.txt"
else:
	file = open('fuzz.spk', 'w')
	with open(sys.argv[1]) as f:
    		for line in f:
			stage_1 = line.replace(' ',' \ns_string("')
			stage_2 = ''.join(('s_string("',stage_1,''))
			file.write("//New requestLine: \n"+stage_2.replace('\n','");\n'))
			file.write('s_string("\\r\\n");\n \n \n')

	print 'Now check the fuzz.txt and change your fuzzing attributes from s_string("Var1"); -> s_string_variable("Var");'
			

